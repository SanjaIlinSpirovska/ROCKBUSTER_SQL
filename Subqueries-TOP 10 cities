--SQL Query to to retrieve TOP 10 cities within the top 10 countries using Subqueries 		
SELECT 	C.city,		
	D.country,		
COUNT (customer_id) AS customer_numbers 			
FROM customer A			
INNER JOIN address B ON A.address_id = B.address_id			
INNER JOIN city C ON B.city_id = C.city_id			
INNER JOIN country D ON C.country_id = D.country_id			
WHERE country in 			
--the top 10 countries for Rockbuster in terms of customer numbers			
(SELECT D.country			
FROM customer A			
INNER JOIN address B ON A.address_id = B.address_id			
INNER JOIN city C ON B.city_id = C.city_id			
INNER JOIN country D ON C.country_id = D.country_id			
GROUP BY country			
ORDER BY count (customer_id) DESC			
LIMIT 10)			
GROUP BY country, city			
ORDER BY count (customer_id) DESC			
LIMIT 10
